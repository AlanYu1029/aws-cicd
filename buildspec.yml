version: 0.2

env:
  parameter-store:
    SECRET: "mysecret" # value is th variable name stored in parameter-store

phases:
  install:
    commands:
      - echo do nothing...
  pre_build:
    commands:
      - echo run unittests om `date`
      - make test
  build:
    commands:
      - echo Build started on `date`
      - make set-secret SECRET=${SECRET}
      - make dist
  post_build:
    commands:
      - echo Build completed on `date`
artifacts:
  files:
    - dist/aws-cicd-0.1.0.tar.gz
    - cf-vpc.yaml
    - cf-vpc-dev-configs.json
    - cf-ec2.yaml
    - cf-ec2-dev-configs.json
